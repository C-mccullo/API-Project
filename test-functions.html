<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
</head>
<body>
	<div id="map" style="height: 500px">
		
	</div>
	<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCkB9y214WJgC8b0Y01ABS1jNOx4elPeeE&callback=initMap"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.js"></script>
	<script>
	'use strict'
	var searchApp = {}
	searchApp.postal = ['M2K 2K7', 'M3A 2S1', 'M3A 2S1', 'M3A 2S1', 'M4C 1H0', 'M4C 5B2', 'M4C 5B2', 'M4C 5B2', 'M8Z 4L5', 'M8Z 4L5', 'L6A 1T1', 'L5B 0H5', 'L5B 0H5', 'L0G 1A0', 'L0G 1A0', 'L8G 3H1', 'N1R 8J6']
	searchApp.lngArray = [];
	searchApp.latArray = [];

	// +++++++++++ TO DISPLAY THE ACTUAL MAP ON THE PAGE +++++++++++++


	// +++++++++++ TO CONVERT POSTAL CODES INTO LAT/LNG +++++++
	searchApp.convertLatLng = function(postal) {
		var counter = 0;
		for (let i = 0; i < searchApp.postal.length; i++) {
			var postal2 = searchApp.postal[i];
			// console.log(postal2);
			$.ajax({
				url: "https://maps.googleapis.com/maps/api/geocode/json",
				method: 'GET',
				dataType: 'json',
				data: {
					address: postal2
				}
			}).then(function(result){
				searchApp.latArray.push(result.results[0].geometry.location.lat)
				searchApp.lngArray.push(result.results[0].geometry.location.lng)
				counter++;

				console.log(counter)
				if (counter === searchApp.postal.length) {
					console.log(searchApp.lngArray);
					console.log(searchApp.latArray);
					// call function that plots things out here
					 searchApp.plotOnMap(searchApp.latArray, searchApp.lngArray);
					
				}
			});
		}
	};


 	// +++++++++++ PLOTS THE ICONS ON THE MAP BASED ON LNG/LAT ++++++++
 	searchApp.plotOnMap = function(latArray, lngArray){

 		for (let i = 0; i < searchApp.postal.length; i++) {
 			var singleLat = latArray[i]
 			var singleLng = lngArray[i]
 			searchApp.myLatLng = {lng: 43.7921395, lat: -79.386151};
	 		// searchApp.map.setCenter(searchApp.myLatLng);
	 		var image = 'http://maps.google.com/mapfiles/ms/icons/blue-dot.png'
			var marker = new google.maps.Marker({
			   position: {
	 		 		lat: singleLat,
	 		 		lng: singleLng
	 		 	},
			   map: searchApp.map,
			   image: image
			 });
			// console.log(marker);
 		}
 		// google.maps.event.trigger(searchApp.map, 'resize');
		// ++++++++ POTENTIAL USE LATER - MARKERS FOR DOG LOCATIONS
 		// var infowindow = new google.maps.InfoWindow({
 		//     content: '<h2>'+ title.text() +'</h2>' + '<h4>' + location.text() + '</h4>' + '<h5>' + website.text() + '</h5>'
 		// });

		// marker.addListener('click', function() {
		// infowindow.open(searchApp.map, marker);

 	};

 	// ++++++ THE ACTUAL MAP ++++++++++
 	searchApp.map;
 	function initMap() {
 	  searchApp.map = new google.maps.Map(document.getElementById('map'), {
 	    center: {lat: 43.7, lng: -79.4},
 	    zoom: 10
 	  });

 	};



	// function = plots out stuff on a map

	$(document).ready(function() {
		// initMap()
		searchApp.convertLatLng();
	});

	</script>
</body>
</html>